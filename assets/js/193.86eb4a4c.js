(window.webpackJsonp=window.webpackJsonp||[]).push([[193],{565:function(_,v,t){"use strict";t.r(v);var r=t(4),e=Object(r.a)({},(function(){var _=this,v=_._self._c;return v("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[v("h1",{attrs:{id:"幂等性问题分析"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#幂等性问题分析"}},[_._v("#")]),_._v(" 幂等性问题分析")]),_._v(" "),v("h2",{attrs:{id:"基础介绍"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#基础介绍"}},[_._v("#")]),_._v(" 基础介绍")]),_._v(" "),v("p",[_._v("幂等性（"),v("em",[_._v("Idempotence")]),_._v("）是计算机科学中的一个重要概念，尤其在分布式系统和网络通信中非常关键。")]),_._v(" "),v("ul",[v("li",[_._v("它描述了"),v("strong",[_._v("在相同条件下，不论一个操作执行多少次，其结果都与执行一次相同")]),_._v("。")]),_._v(" "),v("li",[_._v("这意味着，即使操作被重复请求，系统的状态或返回结果也保持不变。（多次执行同一个操作的结果与执行一次相同）")])]),_._v(" "),v("h2",{attrs:{id:"幂等性的重要性"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#幂等性的重要性"}},[_._v("#")]),_._v(" 幂等性的重要性")]),_._v(" "),v("ol",[v("li",[v("strong",[_._v("数据一致性")]),_._v("：确保系统在面对重复请求时，数据保持一致，不会因为多次操作而导致数据错误或状态不一致。")]),_._v(" "),v("li",[v("strong",[_._v("系统稳定性")]),_._v("：通过减少因重复操作带来的潜在错误，提高系统的整体稳定性和可靠性。")]),_._v(" "),v("li",[v("strong",[_._v("简化错误处理")]),_._v("：在幂等系统中，重复请求可以直接返回成功，无需复杂的错误处理逻辑。")])]),_._v(" "),v("h2",{attrs:{id:"实现幂等性的方法"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#实现幂等性的方法"}},[_._v("#")]),_._v(" 实现幂等性的方法")]),_._v(" "),v("ol",[v("li",[v("strong",[_._v("唯一标识符法")]),_._v("：通过为每个操作生成一个全局唯一的标识符（如 "),v("code",[_._v("UUID")]),_._v("），并在执行操作前检查该标识符是否已存在，以此确保操作不被重复执行 。（"),v("code",[_._v("自定义注解 + AOP 切面 + redis 分布式锁")]),_._v("）")]),_._v(" "),v("li",[v("strong",[_._v("状态检查法")]),_._v("：在执行操作前，先检查操作对象的状态，确保只有在满足特定条件时才执行操作。")]),_._v(" "),v("li",[v("strong",[_._v("Token 机制")]),_._v("：核心思想就是，每次操作都生成一个唯一 Token 凭证，服务器通过这个唯一凭证保证同样的操作不会被执行两次。\n"),v("ul",[v("li",[_._v("这个 Token 除了字面形式上的 "),v("code",[_._v("唯一字符串")]),_._v("，也可以是 "),v("code",[_._v("多个标志的组合")]),_._v("（比如上面提到的状态标志），甚至可以是 "),v("code",[_._v("时间段标识")]),_._v(" 等等。")])])]),_._v(" "),v("li",[v("strong",[_._v("去重队列")]),_._v("：使用消息队列时，可以设置去重机制，确保相同的消息只被消费一次。")]),_._v(" "),v("li",[v("strong",[_._v("数据库层面的约束")]),_._v("：利用数据库的唯一约束（"),v("em",[_._v("Unique Constraint")]),_._v("）来防止重复数据的插入。")]),_._v(" "),v("li",[v("strong",[_._v("乐观锁")]),_._v("：在数据库中设计订单记录时，可以添加一个 "),v("code",[_._v("版本号")]),_._v(" 或 "),v("code",[_._v("时间戳字段")]),_._v("。在创建订单前，检查数据库中是否存在匹配的记录，并且 "),v("code",[_._v("版本号")]),_._v(" 或 "),v("code",[_._v("时间戳")]),_._v(" 与当前请求的一致，若一致则继续处理，否则认为订单已存在。")]),_._v(" "),v("li",[v("strong",[_._v("会话管理")]),_._v("：在用户的会话（Session）中记录当前的购物车信息和下单状态。当用户点击“立即购买”时，系统检查会话中是否有未完成的下单操作。")])]),_._v(" "),v("blockquote",[v("p",[_._v("总结：核心思路是利用 "),v("code",[_._v("唯一标识")]),_._v(" 来进行 校验处理")])]),_._v(" "),v("h2",{attrs:{id:"应用实例"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#应用实例"}},[_._v("#")]),_._v(" 应用实例")]),_._v(" "),v("p",[_._v("以电商平台下单为例，系统需要确保用户点击“立即购买”按钮时，订单不会被重复创建。")]),_._v(" "),v("p",[_._v("这可以通过以下步骤实现：")]),_._v(" "),v("ol",[v("li",[v("strong",[_._v("生成订单流水号")]),_._v("：在用户点击购买时，系统生成一个唯一的 "),v("code",[_._v("订单流水号")]),_._v("。")]),_._v(" "),v("li",[v("strong",[_._v("检查订单是否存在")]),_._v("：在创建订单前，检查数据库中是否已存在该 "),v("code",[_._v("订单流水号")]),_._v(" 的记录。")]),_._v(" "),v("li",[v("strong",[_._v("创建订单")]),_._v("：如果订单不存在，则创建新订单并存储到数据库；如果已存在，则返回提示信息“订单已存在”。")])]),_._v(" "),v("h2",{attrs:{id:"注意事项"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[_._v("#")]),_._v(" 注意事项")]),_._v(" "),v("ul",[v("li",[v("strong",[_._v("全局唯一性")]),_._v("：确保用于幂等性检查的标识符在全局范围内是唯一的。")]),_._v(" "),v("li",[v("strong",[_._v("性能考虑")]),_._v("：幂等性检查可能会引入额外的性能开销，需要合理设计以平衡性能和稳定性。")]),_._v(" "),v("li",[v("strong",[_._v("并发控制")]),_._v("：在高并发场景下，需要采取适当的并发控制机制，以确保幂等性检查的正确性 。")])]),_._v(" "),v("h2",{attrs:{id:"结语"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#结语"}},[_._v("#")]),_._v(" 结语")]),_._v(" "),v("p",[_._v("通过合理设计幂等性检查机制，可以有效地避免因重复操作带来的数据错误、资源浪费和系统崩溃等问题，从而构建更加健壮和可靠的系统。")]),_._v(" "),v("h2",{attrs:{id:"学习参考"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#学习参考"}},[_._v("#")]),_._v(" 学习参考")]),_._v(" "),v("ul",[v("li",[v("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/609110314?utm_id=0",target:"_blank",rel:"noopener noreferrer"}},[_._v("保证接口幂等的八个锦囊 - 知乎 (zhihu.com)"),v("OutboundLink")],1)]),_._v(" "),v("li",[v("a",{attrs:{href:"http://1.119.164.247:8090/idempotent/#_1-%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86",target:"_blank",rel:"noopener noreferrer"}},[_._v("幂等性（防重复提交） | ruoyi-vue-pro 开发指南"),v("OutboundLink")],1)]),_._v(" "),v("li",[v("a",{attrs:{href:"https://cloud.baidu.com/article/3356498",target:"_blank",rel:"noopener noreferrer"}},[_._v("深入理解幂等设计：确保系统稳定与数据一致性的关键 (baidu.com)"),v("OutboundLink")],1)]),_._v(" "),v("li",[v("a",{attrs:{href:"https://blog.csdn.net/final_me/article/details/108031400",target:"_blank",rel:"noopener noreferrer"}},[_._v("幂等 (idempotence) 的概念-CSDN博客"),v("OutboundLink")],1)])]),_._v(" "),v("p",[_._v("[TOC]")])])}),[],!1,null,null,null);v.default=e.exports}}]);